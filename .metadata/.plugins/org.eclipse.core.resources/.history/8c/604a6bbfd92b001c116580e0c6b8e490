#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <limits.h>

#include "Funciones.h"

#define TRUE 0
#define FALSE 1

int InicializarClientes(Clientes* listado,Recoleccion* cliente, int len){

	setbuf(stdout,NULL);

	int retorno;
	retorno = -1;

	if(listado != NULL && cliente != NULL && len>=0){
		for (int i = 0; i < len; i++) {
		listado[i].isEmpty = TRUE;
		cliente[i].isEmpty = TRUE;
		cliente[i].cantidadPedidosPendientes = 0;
		cliente[i].cantidadPedidosCompletados = 0;
		}
		retorno = 0;
	}


	return retorno;

}



int AniadirCliente(Clientes* listado, int len, int id, char nombreEmpresa[],char cuit[],char direccion[], char localidad[]){

	int flag = TRUE;
	int retorno = -1;


     for ( int i = 0;  i < len; ++ i) {

		if(listado != NULL && len > 0 && id > 0 &&  listado[i].isEmpty== TRUE && flag == TRUE ){


			listado[i].idCliente = id;
			strcpy(listado[i].nombreEmpresa, nombreEmpresa);
			strcpy(listado[i].cuit, cuit);
			strcpy(listado[i].direccion, direccion);
			strcpy(listado[i].localidad, localidad);
			listado[i].isEmpty = FALSE;

			flag = FALSE;
			retorno = 0;
			}
		}

    return retorno;
}
int EncontrarClientePorId(Clientes* listado, int len,int id){

	int retorno = -1;
	for (int i = 0; i < len; ++i) {

		 if(listado[i].idCliente == id){

			 retorno = i;

		}
    }

    return retorno;

}
void ModificarCliente( Clientes* listado, int len, int id){

	int ModificarLocalidad;
    int retorno = -1;
    retorno = EncontrarClientePorId(listado,len,id);

	if(retorno != -1 ){
         printf("¿Quiere cambiar la localidad y direccion?\n 1-Si \n 2-No: ");
		 scanf ("%d",&ModificarLocalidad);

		 switch (ModificarLocalidad) {
			case 1:
				printf("Ingrese la nueva localidad: ");
				fflush(stdin);
				gets(listado[retorno].localidad);


				printf("Ingrese la nueva direccion: ");
				fflush(stdin);
				gets(listado[retorno].direccion);
				break;
			case 2:
				printf("Saliendo...\n");

				break;

		 }
	}
	else{
		printf("No existe ningun empleado con ese ID\n");

	}
}
int EliminarCliente(Clientes* listado, int len, int id){

	int retorno = -1;
	int respuesta = -1;
    if(listado != NULL && len > 0 && id > 0){
		retorno = EncontrarClientePorId(listado,len,id);
		printf("¿Esta seguro que desea eliminar el usuario de ID: %d? \n 1-Si \n 2-No: ",id);
		scanf("%d",&respuesta);
		if(retorno != -1 &&  respuesta == 1 ){

				if(listado[retorno].idCliente == id )
				{
					listado[retorno].isEmpty = TRUE;
				}

			printf("Elimado usuario de ID: %d con éxito\n",id);
		}
		else{
			printf("No se ha eliminado el cliente. Saliendo...\n");
		}
    }
	return retorno;
}
int PedidoRecoleccion(Clientes* listadoClientes,Recoleccion* listadoRecoleccion,int len, int idCliente, float cantidadKilos,int idRecoleccion){
	int retorno = -1;

	if(listadoClientes != NULL && listadoRecoleccion != NULL && len > 0 && idCliente > 0 && cantidadKilos > 0 && idRecoleccion > 0){
	   retorno = EncontrarClientePorId(listadoClientes,len,idCliente);
	   retorno +1;
       if(retorno != -1){
    	  listadoRecoleccion[retorno].idCliente = idCliente;
    	  listadoRecoleccion[retorno].idRecoleccion = idRecoleccion;
          listadoRecoleccion[retorno].isEmpty = FALSE;
          listadoRecoleccion[retorno].kilos = cantidadKilos;
          listadoRecoleccion[retorno].cantidadPedidosPendientes++;

       }
       else{
    	   printf("No existe nadie con ese ID");
       }
	}

	return retorno;

}

